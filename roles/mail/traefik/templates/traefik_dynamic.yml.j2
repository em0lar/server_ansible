http:
  routers:
    api_http:
      rule: "Host(`traefik.{{inventory_hostname}}`)"
      service: "api@internal"
      entryPoints:
        - "http"
      middlewares:
        - "https_redirect"
    api_https:
      rule: "Host(`traefik.{{inventory_hostname}}`)"
      tls:
        certResolver: "le_tls"
      service: "api@internal"
      entryPoints:
        - "https"
      middlewares:
        - "api_auth"
  middlewares:
    https_redirect:
      redirectScheme:
        scheme: "https"
    api_auth:
      basicAuth:
        realm: "Tickets, please!"
        removeHeader: true
        users:
          - "labcode:$apr1$h8hfBKva$F/yHCivbn8V3tIahYaNQE/"
    cors:
      headers:
        accessControlAllowOrigin: "*"
        addVaryHeader: true